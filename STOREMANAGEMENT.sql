CREATE DATABASE STOREMANAGEMENT
GO

USE STOREMANAGEMENT
GO

CREATE TABLE ACCOUNT
(
	USERNAME VARCHAR(100),
	PASSWORD VARCHAR(100),

	CONSTRAINT PK_ACCOUNT PRIMARY KEY (USERNAME)
)
GO

CREATE TABLE STORE
(
	ID INT,
	NAME NVARCHAR(100),
	TYPEOFSTORE INT,
	PHONE VARCHAR(10),
	ADDRESS NVARCHAR(100),
	DISTRICT NVARCHAR(100),
	CHECKIN DATE,
	DEBT BIGINT,

	CONSTRAINT PK_STORE PRIMARY KEY (ID)
)
GO

CREATE TABLE TYPEOFSTORE
(
	ID INT,
	NAME NVARCHAR(100),
	MAXOFDEBT BIGINT,

	CONSTRAINT PK_TYPEOFSTORE PRIMARY KEY (ID)
)
GO

CREATE TABLE BILL
(
	ID INT,
	STOREID INT,
	CHECKOUT DATE,
	TOTAL BIGINT,

	CONSTRAINT PK_BILL PRIMARY KEY (ID)
)

CREATE TABLE BILLINFO
(
	BILLID INT,
	GOODSID INT,
	COUNT INT,

	CONSTRAINT PK_BILLINFO PRIMARY KEY (BILLID, GOODSID)
)
GO

CREATE TABLE GOODS
(
	ID INT,
	NAME NVARCHAR(100),
	UNIT NVARCHAR(100),
	COSTPRICE BIGINT,
	PRICE BIGINT,
	COUNT INT,

	CONSTRAINT PK_GOODS PRIMARY KEY (ID)
)
GO

ALTER TABLE BILLINFO
ADD CONSTRAINT FK_BillInfoGoods 
FOREIGN KEY (GOODSID) REFERENCES GOODS(ID)
GO

ALTER TABLE BILLINFO
ADD CONSTRAINT FK_BillInfoBill
FOREIGN KEY (BILLID) REFERENCES BILL(ID)
GO

ALTER TABLE BILL
ADD CONSTRAINT FK_BillStore
FOREIGN KEY (STOREID) REFERENCES STORE(ID)
GO

ALTER TABLE STORE
ADD CONSTRAINT FK_StoreOfType
FOREIGN KEY (TYPEOFSTORE) REFERENCES TYPEOFSTORE(ID)
GO



